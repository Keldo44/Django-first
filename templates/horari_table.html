<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Academic Schedule</title>
    <style>
        :root {
            --bg-dark: #0a0a0a;
            --grid-line: rgba(255, 255, 255, 0.1); /* Very light grey for grid lines */
            --glass-border: rgba(255, 255, 255, 0.08);
            --text-main: #ffffff;
            --text-dim: #777777;
            --accent-gold: #daa520;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Inter', -apple-system, sans-serif;
            margin: 0;
            padding: 40px;
            display: flex;
            justify-content: center;
        }

        /* Container with the grid lines */
        .schedule-wrapper {
            top:0;
            left:0;
            right: 0;
            bottom: 0;
            height: -webkit-fit-content;
            height: -moz-fit-content;
            margin: auto;
            position: absolute;

            display: grid;
            width: 100%;
            max-width: 1200px;
            grid-template-columns: 80px repeat(5, 1fr);
            grid-template-rows: 60px; /* Header height */
            grid-auto-rows: 90px;      /* Hour height */

            /* The 'Gap' creates the grid lines by showing the background through */
            background-color: var(--grid-line);
            gap: 1px;

            border-radius: 16px;
            border: 1px solid var(--glass-border);
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);

            animation: fadein 1.2s ease-in-out forwards;

        }
        @keyframes fadein {
            from {
                opacity: 0;
                transform: scale(0.94);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(30px); /* Empieza 30px abajo */
            }
            to {
                opacity: 1;
                transform: translateY(0);    /* Termina en su posici√≥n original */
            }
        }

        /* Base style for all 'empty' or label cells to have a solid background */
        .cell-fill {
            background-color: var(--bg-dark);
        }

        .day-label {
            grid-row: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 0.9rem;
            letter-spacing: 2px;
            color: var(--accent-gold);
            background: #111; /* Slightly different to distinguish header */
            text-transform: uppercase;
        }

        .hour-label {
            grid-column: 1;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-dim);
            background: rgba(0, 0, 0, 0.4);
        }

        /* The Class Cards */
        .class-box {

            background: linear-gradient(
                145deg,
                color-mix(in srgb, var(--color), transparent 85%),
                color-mix(in srgb, var(--color), transparent 95%)
            );
            border-left: 4px solid var(--color);
            border-top: 1px solid rgba(255,255,255,0.1);
            margin: 4px;
            padding: 12px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            z-index: 2; /* Sits above the grid-fill cells */

            grid-row-start: var(--start);
            grid-row-end: var(--end);
            grid-column: var(--day);

            opacity: 0; /* Empiezan invisibles */
            animation: fadeUp 0.8s ease-out forwards;

            /* El retraso base de 1s + un incremento basado en la variable --i */
            animation-delay: calc(1s + (var(--i) * 0.1s));
        }

        .class-box:hover {
            transform: translateY(-3px) scale(1.01);
            background: color-mix(in srgb, var(--color), transparent 75%);
            z-index: 10;
        }

        .time-tag {
            font-size: 0.7rem;
            color: #fff;
            opacity: 0.6;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .subject-title {
            font-size: 0.95rem;
            font-weight: 700;
            margin: 0;
            color: #fff;
        }

        .room-info {
            font-size: 0.7rem;
            color: var(--text-dim);
            margin-top: auto;
        }

        .corner {
            grid-row: 1;
            grid-column: 1;
            background: #111;
        }

        .upload_button, .download_button {



            /* Flexbox centers the icon perfectly */
            display: flex;
            align-items: center;
            justify-content: center;

            /* Sizing & Shape */
            width: 60px;
            height: 60px;
            border-radius: 50%; /* Circular buttons usually look better for FABs */

            /* Border & Colors */
            text-decoration: none;
            color: var(--accent-gold);
            border: 2px solid var(--accent-gold);
            background: transparent;

            opacity: 0;

            animation: fadeUp 0.8s ease-out 1s forwards;
            /* Smooth Transition */
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(20px) brightness(0.5);
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .upload_button:hover, .download_button:hover {
            /* Instead of changing border-width (which moves things),
               we use a background fill or a shadow scale */
            background-color: var(--accent-gold);
            transform: translateY(-5px); /* Adds a "lift" effect */
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        .upload_button svg, .download_button svg {
            fill: var(--accent-gold);
            width: 28px; /* Consistent sizing */
            height: 28px;
            transition: fill 0.3s ease;
        }

        .upload_button:hover svg , .download_button:hover svg {
            /* Flip the icon color so it's visible against the gold background */
            fill: #ffffff;
        }

        .download_button svg{
            width: 20px;
        }

        .buttons{
            position: fixed;
            bottom: 50px;
            right: 50px;
            gap: 25px;
            display: flex;
            flex-direction: row-reverse;
            justify-content: center;
            align-items: center;

        }

        @media screen and (max-width: 1080px) {
            .subject-title{
                font-size: 1.3vw;
            }
            body{
                overflow: scroll;
            }
        }


    </style>
</head>
<body>

    <div class="schedule-wrapper">
        <div class="corner"></div>
        <div class="day-label" style="grid-column: 2;">LUN</div>
        <div class="day-label" style="grid-column: 3;">MAR</div>
        <div class="day-label" style="grid-column: 4;">MIE</div>
        <div class="day-label" style="grid-column: 5;">JUE</div>
        <div class="day-label" style="grid-column: 6;">VIE</div>

        {% for h in hour_range %}
            <div class="hour-label" style="grid-row: {{ forloop.counter|add:1 }};">
                {{ h }}:00
            </div>

            {% for i in "23456"|make_list %}
                <div class="cell-fill" style="grid-row: {{ forloop.parentloop.counter|add:1 }}; grid-column: {{ i }};"></div>
            {% endfor %}
        {% endfor %}

        {% for item in myClasses %}
            <div class="class-box"
                 style="--day: {{ item.weekday|add:2 }};
                        --start: {{ item.start_hour.hour|add:2|add:neg_start_hour_limit }};
                        --end: {{ item.end_hour.hour|add:2|add:neg_start_hour_limit }};
                        --color: {{ item.subject.color }};
                        --i: {{ forloop.counter|add:0.1 }}">

                <div class="time-tag">

                </div>

                <h3 class="subject-title">{{ item.subject.name }}</h3>

                <div class="room-info">
                </div>
            </div>
        {% endfor %}
    </div>

    <div class="buttons">
        <a class="upload_button" href="/file"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M352 128C352 110.3 337.7 96 320 96C302.3 96 288 110.3 288 128L288 288L128 288C110.3 288 96 302.3 96 320C96 337.7 110.3 352 128 352L288 352L288 512C288 529.7 302.3 544 320 544C337.7 544 352 529.7 352 512L352 352L512 352C529.7 352 544 337.7 544 320C544 302.3 529.7 288 512 288L352 288L352 128z"/></svg></a>
        <a class="download_button" href="/download/horario" download="horario.txt">
            <svg viewBox="0 0 15 17" xmlns="http://www.w3.org/2000/svg">
                <path d="M6.65685 16.7071C7.04738 17.0976 7.68054 17.0976 8.07107 16.7071L14.435 10.3431C14.8256 9.95262 14.8256 9.31946 14.435 8.92893C14.0445 8.53841 13.4113 8.53841 13.0208 8.92893L7.36396 14.5858L1.70711 8.92893C1.31658 8.53841 0.683418 8.53841 0.292894 8.92893C-0.0976312 9.31946 -0.0976312 9.95262 0.292894 10.3431L6.65685 16.7071ZM7.36396 0C6.81168 0 6.36396 0.447715 6.36396 1V16H7.36396H8.36396V1C8.36396 0.447715 7.91625 0 7.36396 0Z"/>
            </svg>
        </a>
    </div>


</body>
</html>